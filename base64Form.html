<meta charset="UTF-8">
<script src="scripts/material.min.js"></script>
<script src="scripts/jquery-latest.min.js" type="text/javascript"></script>
<script src="scripts/CryptFunc.js" type="text/javascript"></script>


<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-deep_purple.min.css"/>

<style type="text/css">
    .center {
        width: 98%;
        padding: 1%;
    }

    .demo-content {
        max-width: 1080px;
    }

    .mdl-textfield--floating-label {
        width: 100%;
    }

    .mdl-textfield__input {
        min-height: 40px;
        font-family: 'Roboto', 'Helvetica', sans-serif;
        font-weight: 400;

    }

    .mdl-card__actions {
        display: flex;
        box-sizing: border-box;
        align-items: center;
    }

    .mdl-card__actions > .mdl-button--icon {
        margin-right: 5px;
        margin-left: 5px;
        width: 40px;
        height: 40px;
    }

    .material-icons {
        font-size: 26px;
    }

    .mdl-layout-spacer h1 {
        text-align: center;
    }

    h1 {
        -webkit-align-self: flex-end;
        -ms-flex-item-align: end;
        align-self: flex-end;
        color: inherit;
        display: block;
        font-size: 24px;
        font-weight: 300;
        line-height: normal;
        overflow: hidden;
        -webkit-transform-origin: 149px 48px;
        transform-origin: 149px 48px;
        margin: 0
    }

    body {
        height: 100%
    }

    .onlyMobile{
        visibility: collapse;
    }
    @media (max-width: 500px) {
        .onlyMobile{
            visibility: visible;
        }
        .onlyPC{
            visibility: collapse;
        }
    }

</style>

<div class="mdl-grid demo-content">
    <div class="mdl-cell mdl-cell--12-col mdl-card mdl-shadow--4dp">
        <div class="center">
            <div class="mdl-card__actions">
                <div class="mdl-layout-spacer"><h1>Base64</h1></div>
                <div class="mdl-tooltip mdl-tooltip--large" for="toolTip">
                    Base64 - это группа аналогичных схем кодирования двоичного текста, которые представляют двоичные
                    данные
                    в формате строки ASCII путем перевода их в представление radix-64. Термин Base64 происходит от
                    определенной кодировки передачи содержимого MIME.

                    Каждая цифра base64 представляет ровно 6 бит данных. Таким образом, три 8-битных байта (т. е. всего
                    24
                    бита) могут быть представлены четырьмя 6-битными цифрами base64.
                </div>
                <button id="toolTip" class="mdl-button mdl-button--icon mdl-button--colored"><i class="material-icons">info_outline</i>
                </button>
            </div>
            <div class="mdl-textfield--floating-label mdl-js-textfield mdl-textfield">
                <textarea class="mdl-textfield__input" type="text" rows="5" id="InputText"></textarea>
                <label id="LabelText" class="mdl-textfield__label" for="InputText">Текст</label>
            </div>

            <div class="mdl-textfield--floating-label mdl-js-textfield mdl-textfield">
                <textarea class="mdl-textfield__input" type="text" rows="5" id="CryptText"></textarea>
                <label id="CryptLabel" class="mdl-textfield__label" for="CryptText">Результат</label>
            </div>


            <div class="mdl-card__actions">
                <button class="mdl-button mdl-button--icon mdl-button--colored onlyMobile"
                        onclick="Click(0); return false;"><i class="material-icons">switch_left</i>
                </button>

                <button class="mdl-button mdl-button--icon mdl-button--colored onlyMobile" style="margin-right: 1%"
                        onclick="Click(1); return false;">
                    <i class="material-icons">switch_right</i>
                </button>

                <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect onlyPC" id="coded"
                   onclick="Click(0); return false;">Кодировать</a>

                <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect onlyPC" id="decoded"
                   onclick="Click(1); return false;">Декодировать</a>

                <div class="mdl-layout-spacer"></div>

                <button class="mdl-button mdl-button--icon mdl-button--colored"
                        onclick="copyToClipboard(); return false;"><i class="material-icons">content_copy</i>
                </button>

                <button class="mdl-button mdl-button--icon mdl-button--colored" style="margin-right: 1%"
                        onclick="ClearFields(); return false;">
                    <i class="material-icons">clear</i>
                </button>
            </div>
        </div>
    </div>

    <div class="mdl-cell mdl-cell--12-col mdl-card mdl-shadow--4dp">
        <div class="mdl-card__title">
            <h2 class="mdl-card__title-text">Описание</h2>
        </div>
        <div class="mdl-card__supporting-text no-padding">
            <p>Base64 - это группа аналогичных схем кодирования двоичного текста, которые представляют двоичные данные в
                формате строки ASCII путем перевода их в представление radix-64. Термин Base64 происходит от
                определенной кодировки передачи содержимого MIME.
            </p>
            <p>
                Каждая цифра base64 представляет ровно 6 бит данных. Таким образом, три 8-битных байта (т. е. всего 24
                бита) могут быть представлены четырьмя 6-битными цифрами base64.
            </p>
            <p>
                Определенный набор из 64 символов, выбранных для представления 64 мест-значений для базы, варьируется
                между реализациями. Общая стратегия состоит в том, чтобы выбрать 64 символа, которые являются членами
                подмножества, общего для большинства кодировок, а также для печати. Эта комбинация оставляет данные,
                которые вряд ли будут изменены при передаче через информационные системы, такие как электронная почта,
                которые традиционно не были 8-битными чистыми. Например, реализация Base64 MIME использует A-Z, A-z и
                0-9 для первых 62 значений. Другие варианты разделяют это свойство, но отличаются символами, выбранными
                для последних двух значений; примером является UTF-7.
            </p>
            <p>
                Самые ранние экземпляры этого типа кодирования были созданы для коммутируемой связи между системами,
                работающими под управлением той же ОС — например, uuencode для UNIX, BinHex для TRS-80 (позже
                адаптированный для Macintosh) — и поэтому могли бы сделать больше предположений о том, какие символы
                были безопасны для использования. Например, uuencode использует прописные буквы, цифры и много знаков
                препинания, но не строчные.
            </p>
        </div>
    </div>
</div>

<script type="text/javascript">

    document.getElementById("coded").addEventListener("touchstart", Click(0), false);
    document.getElementById("decoded").addEventListener("touchstart", Click(1), false);

    function Click(Choice) {
        // 0 - кодировать, 1 - декодировать
        const inputText = document.getElementById("InputText").value;
        if (inputText.length > 0) {
            NewClick();
            switch (Choice) {
                case 0: {
                    document.getElementById("CryptText").value = utf8_to_b64(inputText);
                    break
                }
                case 1: {
                    document.getElementById("CryptText").value = b64_to_utf8(inputText);
                    break
                }
            }
            document.getElementById("CryptText").focus();
            document.getElementById("CryptText").parentNode.classList.add('is-dirty');
            setCharCounter();
        }
    }

    function setCharCounter() {
        const inputField = document.getElementById("InputText").value.length;
        const outputField = document.getElementById("CryptText").value.length;

        const inputLabel = document.getElementById("LabelText");
        const outputLabel = document.getElementById("CryptLabel");

        if (inputField !== 0 && outputField !== 0) {
            inputLabel.innerHTML = "Текст" + " (" + inputField + ")";
            outputLabel.innerHTML = "Результат" + " (" + outputField + ")";
        } else {
            inputLabel.innerHTML = "Текст";
            outputLabel.innerHTML = "Результат";
        }
    }

    function NewClick() {
        document.getElementById("CryptText").value = "";
    }

    function ClearFields() {
        document.getElementById("CryptText").value = '';
        document.getElementById("InputText").value = '';
        document.getElementById("InputText").blur();
        document.getElementById("CryptText").blur();


        document.getElementById("CryptText").parentNode.classList.remove('is-dirty');
        document.getElementById("InputText").parentNode.classList.remove('is-dirty');

        setCharCounter();
    }

    function copyToClipboard() {
        if (document.getElementById("CryptText").value.length > 0) {
            document.getElementById("CryptText").select();
            document.execCommand('copy');
            window.getSelection().removeAllRanges();
        }
    }

    // var oldVal = "";
    // var handle;
    //
    // $("#InputText").on("change keyup paste", function() {
    //     if(handle)
    //     clearTimeout(handle);
    //     var currentVal = $(this).val();
    //     if(currentVal === oldVal) {
    //         return;
    //     }
    //     oldVal = currentVal;
    //
    //     handle = setTimeout(
    //         () => {
    //          Click(0);
    //         },
    //         800
    //     );
    // });
</script>